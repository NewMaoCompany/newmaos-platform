-- ============================================================
-- Unit 1 Questions (Limits) — CLEAN REPLACE
-- Generated by Antigravity
-- ============================================================
BEGIN;

-- Step 0: Ensure topic_content + skills + error_tags
INSERT INTO public.topic_content (id, title, description) VALUES
  ('Both_Limit', 'AP_Calculus_BC Both_Limit', 'Unit 1 Limits')
ON CONFLICT (id) DO NOTHING;

INSERT INTO public.skills (id, name, unit) VALUES
  ('DifferenceQuotient', 'DifferenceQuotient', 'Both_Limit'),
  ('SKL_DifferenceQuotient', 'SKL_DifferenceQuotient', 'Both_Limit'),
  ('SKL_AverageRateOfChange', 'SKL_AverageRateOfChange', 'Both_Limit'),
  ('SecantSlope', 'SecantSlope', 'Both_Limit'),
  ('AverageRateOfChange', 'AverageRateOfChange', 'Both_Limit'),
  ('LimitConcept', 'LimitConcept', 'Both_Limit'),
  ('InstantaneousRateIdea', 'InstantaneousRateIdea', 'Both_Limit'),
  ('SKL_LimitConcept', 'SKL_LimitConcept', 'Both_Limit'),
  ('AlgebraSimplification', 'AlgebraSimplification', 'Both_Limit'),
  ('SKL_AlgebraicManipulation', 'SKL_AlgebraicManipulation', 'Both_Limit'),
  ('UnitsInterpretation', 'UnitsInterpretation', 'Both_Limit'),
  ('SKL_UnitsInterpretation', 'SKL_UnitsInterpretation', 'Both_Limit'),
  ('SKL_LimitNotation', 'SKL_LimitNotation', 'Both_Limit'),
  ('LimitNotation', 'LimitNotation', 'Both_Limit'),
  ('OneSidedLimits', 'OneSidedLimits', 'Both_Limit'),
  ('LimitExistence', 'LimitExistence', 'Both_Limit'),
  ('SKL_LimitExistence', 'SKL_LimitExistence', 'Both_Limit'),
  ('SKL_OneSidedLimits', 'SKL_OneSidedLimits', 'Both_Limit'),
  ('DirectSubstitution', 'DirectSubstitution', 'Both_Limit'),
  ('LimitLaws', 'LimitLaws', 'Both_Limit'),
  ('SKL_LimitLaws', 'SKL_LimitLaws', 'Both_Limit'),
  ('SKL_PiecewiseAnalysis', 'SKL_PiecewiseAnalysis', 'Both_Limit'),
  ('PiecewiseAnalysis', 'PiecewiseAnalysis', 'Both_Limit')
ON CONFLICT (id) DO NOTHING;

INSERT INTO public.error_tags (id, name, unit, severity, category) VALUES
  ('UsingPointInsteadOfInterval', 'UsingPointInsteadOfInterval', 'Both_Limit', 1, 'General'),
  ('SlopeSignConfusion', 'SlopeSignConfusion', 'Both_Limit', 1, 'General'),
  ('UnitsMismatch', 'UnitsMismatch', 'Both_Limit', 1, 'General'),
  ('PluggingHInsteadOfLimiting', 'PluggingHInsteadOfLimiting', 'Both_Limit', 1, 'General'),
  ('DistributingErrors', 'DistributingErrors', 'Both_Limit', 1, 'General'),
  ('SignErrorInSubstitution', 'SignErrorInSubstitution', 'Both_Limit', 1, 'General'),
  ('FactoringMistake', 'FactoringMistake', 'Both_Limit', 1, 'General'),
  ('CancelingNoncommonFactors', 'CancelingNoncommonFactors', 'Both_Limit', 1, 'General'),
  ('SignErrorInExpansion', 'SignErrorInExpansion', 'Both_Limit', 1, 'General'),
  ('ConfusingFunctionValueWithLimit', 'ConfusingFunctionValueWithLimit', 'Both_Limit', 1, 'General'),
  ('LeftRightMixUp', 'LeftRightMixUp', 'Both_Limit', 1, 'General'),
  ('AssumingLimitExists', 'AssumingLimitExists', 'Both_Limit', 1, 'General'),
  ('DomainRestrictionIgnored', 'DomainRestrictionIgnored', 'Both_Limit', 1, 'General'),
  ('ArithmeticSlip', 'ArithmeticSlip', 'Both_Limit', 1, 'General'),
  ('ConfusingArrowDirection', 'ConfusingArrowDirection', 'Both_Limit', 1, 'General')
ON CONFLICT (id) DO NOTHING;

-- Step 1: Expand representation_type constraint
ALTER TABLE public.questions DROP CONSTRAINT IF EXISTS questions_representation_type_check;
ALTER TABLE public.questions ADD CONSTRAINT questions_representation_type_check
  CHECK (representation_type::text = ANY (ARRAY['symbolic','graph','table','verbal','mixed','text','image']::text[]));

-- Step 2: Disable user triggers (version trigger)
ALTER TABLE public.questions DISABLE TRIGGER USER;

-- Step 3: Nuke ALL Unit 1.1/1.2 questions (and their FK refs)
DELETE FROM public.question_skills WHERE question_id IN (SELECT id FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit'));
DELETE FROM public.question_error_patterns WHERE question_id IN (SELECT id FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit'));
DELETE FROM public.question_versions WHERE question_id IN (SELECT id FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit'));
DELETE FROM public.user_question_state WHERE question_id IN (SELECT id FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit'));
DELETE FROM public.recommendations WHERE question_id IN (SELECT id FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit'));
DELETE FROM public.question_attempts WHERE question_id IN (SELECT id FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit'));
DELETE FROM public.questions WHERE sub_topic_id IN ('Unit1_1.2', 'Unit1_1.1') AND topic_id IN ('Both_Limit');

-- Step 4: Insert new questions
-- Q1
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.1', 'mcq', FALSE, 2, 75, ARRAY['AverageRateOfChange', 'SecantSlope', 'DifferenceQuotient'], ARRAY['UsingPointInsteadOfInterval', 'SlopeSignConfusion', 'UnitsMismatch'], 'A particle’s position is given by $s(t)=t^2+2t$ (meters), where $t$ is in seconds. What is the average velocity on the interval $[1,3]$?', 's(t)=t^2+2t,\ \text{Average velocity on }[1,3]=\frac{s(3)-s(1)}{3-1}', '[{"id": "A", "text": "$6\\ \\text{m/s}$"}, {"id": "B", "text": "$4\\ \\text{m/s}$"}, {"id": "C", "text": "$8\\ \\text{m/s}$"}, {"id": "D", "text": "$10\\ \\text{m/s}$"}]'::jsonb, 'A', NULL, 'Average velocity on $[1,3]$ is the slope of the secant line: $$\frac{s(3)-s(1)}{3-1}=\frac{(9+6)-(1+2)}{2}=\frac{15-3}{2}=6.$$', '{"A": "Correct: secant slope over $[1,3]$ is $6$.", "B": "This can happen if you mistakenly compute $s(3)-s(1)$ as $8$ or divide by the wrong interval length.", "C": "This can happen if you use $\\frac{s(3)}{3}$ or a point-slope confusion instead of a difference quotient.", "D": "This can happen if you divide by $1$ (forgetting $3-1=2$)."}'::jsonb, ARRAY['Core Chapter 1.1 skill: average rate of change as secant slope', 'Builds correct difference-quotient setup'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 3, 1.0, 'symbolic', 'Both_Limit', 'Unit1_1.1', 'NewMaoS', 2026, 'No image needed; purely symbolic average rate-of-change computation.', 0.7, 0.3, 'U1C1.1_AverageVelocity_SecantSlope', 'text', 'SKL_AverageRateOfChange', ARRAY['SKL_DifferenceQuotient']
);

-- Q2
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.1', 'mcq', FALSE, 3, 90, ARRAY['DifferenceQuotient', 'InstantaneousRateIdea', 'LimitConcept'], ARRAY['PluggingHInsteadOfLimiting', 'DistributingErrors', 'SignErrorInSubstitution'], 'Let $f(x)=3x^2-5x$. Which expression represents the slope of the tangent line to $y=f(x)$ at $x=2$ using the definition of derivative?', '\text{Slope at }x=2=\lim_{h\to 0}\frac{f(2+h)-f(2)}{h}', '[{"id": "A", "text": "$\\displaystyle \\lim_{h\\to 0}\\frac{f(2)-f(2-h)}{h}$"}, {"id": "B", "text": "$\\displaystyle \\lim_{h\\to 0}\\frac{f(h)-f(2)}{h-2}$"}, {"id": "C", "text": "$\\displaystyle \\lim_{h\\to 0}\\frac{f(2+h)-f(2)}{h}$"}, {"id": "D", "text": "$\\displaystyle \\lim_{x\\to 0}\\frac{f(2)-f(x)}{2-x}$"}]'::jsonb, 'C', NULL, 'By definition, the slope of the tangent at $x=2$ is $$\lim_{h\to 0}\frac{f(2+h)-f(2)}{h}.$$ This is the limit of secant slopes as the interval shrinks to zero.', '{"A": "This equals $\\lim_{h\\to 0}\\frac{f(2)-f(2-h)}{h}$ which is not the standard form; it also introduces a sign issue unless rewritten carefully.", "B": "This is not anchored at $x=2$ correctly; it mixes $h$ as an $x$-value rather than an increment.", "C": "Correct: increment form at $x=2$.", "D": "This can be correct if written as $\\lim_{x\\to 2}\\frac{f(x)-f(2)}{x-2}$, but the given form has mismatched limit variable ($x\\to 0$)."}'::jsonb, ARRAY['Core Chapter 1.1: instantaneous rate as limit of secant slopes', 'Focuses on correct limit setup rather than computation'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 2, 1.0, 'symbolic', 'Both_Limit', 'Unit1_1.1', 'NewMaoS', 2026, 'No image needed; checks correct derivative-as-limit expression.', 0.8, 0.2, 'U1C1.1_TangentSlope_DefinitionForm', 'text', 'SKL_DifferenceQuotient', ARRAY['SKL_LimitConcept']
);

-- Q3
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.1', 'mcq', FALSE, 4, 120, ARRAY['DifferenceQuotient', 'AlgebraSimplification', 'InstantaneousRateIdea'], ARRAY['FactoringMistake', 'CancelingNoncommonFactors', 'SignErrorInExpansion'], 'Compute the instantaneous rate of change of $g(x)=\sqrt{x}$ at $x=9$ using the limit definition $$g''(9)=\lim_{h\to 0}\frac{\sqrt{9+h}-3}{h}.$$', 'g''(9)=\lim_{h\to 0}\frac{\sqrt{9+h}-3}{h}', '[{"id": "A", "text": "$\\displaystyle \\frac{1}{3}$"}, {"id": "B", "text": "$\\displaystyle \\frac{1}{6}$"}, {"id": "C", "text": "$\\displaystyle \\frac{1}{9}$"}, {"id": "D", "text": "$\\displaystyle \\frac{1}{18}$"}]'::jsonb, 'B', NULL, 'Rationalize: $$\frac{\sqrt{9+h}-3}{h}\cdot\frac{\sqrt{9+h}+3}{\sqrt{9+h}+3}=\frac{(9+h)-9}{h(\sqrt{9+h}+3)}=\frac{1}{\sqrt{9+h}+3}.$$ Taking $h\to 0$ gives $\frac{1}{3+3}=\frac{1}{6}.$', '{"A": "This can happen if you incorrectly cancel $h$ without rationalizing fully.", "B": "Correct: rationalization leads to $\\frac{1}{\\sqrt{9+h}+3}\\to \\frac{1}{6}$.", "C": "This can happen if you substitute $h=0$ too early and treat the expression as $\\frac{\\sqrt{9}-3}{h}$.", "D": "This can happen if you mistakenly get $\\sqrt{9+h}+3\\to 9+3=12$."}'::jsonb, ARRAY['Chapter 1.1: concrete computation from instantaneous-rate limit form', 'Requires correct conjugate technique'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 'Algebraic', 1.2, 'symbolic', 'Both_Limit', 'Unit1_1.1', 'NewMaoS', 2026, 'No image needed; emphasizes conjugate/rationalization within limit definition context.', 0.7, 0.3, 'U1C1.1_InstantRate_Sqrt_Rationalize', 'text', 'SKL_AlgebraicManipulation', ARRAY['SKL_DifferenceQuotient']
);

-- Q4
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.1', 'mcq', FALSE, 1, 60, ARRAY['AverageRateOfChange', 'UnitsInterpretation'], ARRAY['UnitsMismatch', 'UsingPointInsteadOfInterval', 'SlopeSignConfusion'], 'A car’s distance from home (in miles) after $t$ hours is $D(t)$. Which quantity best represents the average speed of the car from $t=2$ to $t=5$?', '\text{Average speed on }[2,5]=\frac{D(5)-D(2)}{5-2}', '[{"id": "A", "text": "$D(5)-D(2)$"}, {"id": "B", "text": "$\\displaystyle \\frac{D(5)-D(2)}{5-2}$"}, {"id": "C", "text": "$\\displaystyle \\frac{D(5)}{5}$"}, {"id": "D", "text": "$D''(2)$"}]'::jsonb, 'B', NULL, 'Average speed over an interval is change in distance divided by change in time: $$\frac{D(5)-D(2)}{5-2}.$$ The units are miles per hour.', '{"A": "This is total change in distance, not per hour.", "B": "Correct: secant slope (miles per hour).", "C": "This averages from $0$ to $5$, not from $2$ to $5$.", "D": "This is an instantaneous rate at $t=2$, not an average over $[2,5]$."}'::jsonb, ARRAY['Chapter 1.1: interprets average rate as slope and correct units', 'Targets common confusion between average and instantaneous'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 2, 0.8, 'symbolic', 'Both_Limit', 'Unit1_1.1', 'NewMaoS', 2026, 'No image needed; language-based interpretation of average rate.', 0.9, 0.1, 'U1C1.1_AverageSpeed_Interpretation', 'text', 'SKL_AverageRateOfChange', ARRAY['SKL_UnitsInterpretation']
);

-- Q5
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.1', 'mcq', FALSE, 5, 135, ARRAY['DifferenceQuotient', 'AlgebraSimplification', 'LimitConcept'], ARRAY['CancelingNoncommonFactors', 'FactoringMistake', 'PluggingHInsteadOfLimiting'], 'Let $p(x)=x^3$. Evaluate $$\lim_{h\to 0}\frac{p(2+h)-p(2)}{h}.$$', '\lim_{h\to 0}\frac{(2+h)^3-8}{h}', '[{"id": "A", "text": "$12$"}, {"id": "B", "text": "$6$"}, {"id": "C", "text": "$8$"}, {"id": "D", "text": "$4$"}]'::jsonb, 'A', NULL, 'Expand: $(2+h)^3=8+12h+6h^2+h^3$. Then $$\frac{(2+h)^3-8}{h}=\frac{12h+6h^2+h^3}{h}=12+6h+h^2.$$ Taking $h\to 0$ gives $12$.', '{"A": "Correct: difference quotient limit equals $12$.", "B": "This can happen if you drop the $6h^2+h^3$ terms too early and then incorrectly simplify.", "C": "This can happen if you confuse $p(2)=8$ with the limit value.", "D": "This can happen if you only keep the linear term as $4h$ due to an expansion mistake."}'::jsonb, ARRAY['Chapter 1.1: connects secant-slope limit to a concrete value', 'Checks careful algebra in difference quotient'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 'Algebraic', 1.3, 'symbolic', 'Both_Limit', 'Unit1_1.1', 'NewMaoS', 2026, 'No image needed; purely symbolic limit of a difference quotient.', 0.7, 0.3, 'U1C1.1_DifferenceQuotient_CubicAt2', 'text', 'SKL_DifferenceQuotient', ARRAY['SKL_AlgebraicManipulation']
);

-- Q6
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.2', 'mcq', FALSE, 2, 75, ARRAY['LimitNotation', 'LimitConcept'], ARRAY['ConfusingFunctionValueWithLimit', 'LeftRightMixUp', 'AssumingLimitExists'], 'Suppose $\lim_{x\to 4} f(x)=7$. Which statement must be true?', '\lim_{x\to 4}f(x)=7', '[{"id": "A", "text": "$f(4)=7$"}, {"id": "B", "text": "$f(x)=7$ for all $x$ near $4$"}, {"id": "C", "text": "For values of $x$ close to $4$ (but not necessarily equal to $4$), $f(x)$ can be made arbitrarily close to $7$."}, {"id": "D", "text": "$\\lim_{x\\to 7} f(x)=4$"}]'::jsonb, 'C', NULL, 'The meaning of $\lim_{x\to 4} f(x)=7$ is that as $x$ approaches $4$, the outputs $f(x)$ approach $7$; this does not force $f(4)$ to equal $7$ or $f$ to be constant near $4$.', '{"A": "Not required: the limit can exist even if $f(4)$ is different or undefined.", "B": "Not required: $f(x)$ can vary and still approach $7$ as $x\\to 4$.", "C": "Correct: this is the core interpretation of a limit.", "D": "Unrelated reversal; not implied by the given limit statement."}'::jsonb, ARRAY['Chapter 1.2: interprets limit notation precisely', 'Targets the common confusion between limit value and function value'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 2, 1.0, 'symbolic', 'Both_Limit', 'Unit1_1.2', 'NewMaoS', 2026, 'No image needed; focuses on correct interpretation of limit notation.', 0.8, 0.2, 'U1C1.2_LimitNotation_Interpretation', 'text', 'SKL_LimitNotation', ARRAY['SKL_LimitConcept']
);

-- Q7
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.2', 'mcq', FALSE, 3, 90, ARRAY['OneSidedLimits', 'LimitExistence'], ARRAY['LeftRightMixUp', 'AssumingLimitExists', 'ConfusingFunctionValueWithLimit'], 'For $x\ne 1$, define $$f(x)=\frac{|x-1|}{x-1}.$$ Which statement is correct?', 'f(x)=\frac{|x-1|}{x-1},\ x\ne 1', '[{"id": "A", "text": "$\\displaystyle \\lim_{x\\to 1} f(x)=1$"}, {"id": "B", "text": "$\\displaystyle \\lim_{x\\to 1} f(x)=-1$"}, {"id": "C", "text": "$\\displaystyle \\lim_{x\\to 1^-} f(x)=-1$ and $\\displaystyle \\lim_{x\\to 1^+} f(x)=1$"}, {"id": "D", "text": "$f(1)=0$"}]'::jsonb, 'B', NULL, 'For $x>1$, $|x-1|=x-1$ so $f(x)=1$. For $x<1$, $|x-1|=-(x-1)$ so $f(x)=-1$. Thus $$\lim_{x\to 1^-}f(x)=-1,\quad \lim_{x\to 1^+}f(x)=1,$$ so the two-sided limit does not exist.', '{"A": "Two-sided limit does not exist because left and right limits differ.", "B": "Incorrect: the two-sided limit does not equal $-1$; only the left-hand limit is $-1$.", "C": "Correct: left-hand is $-1$, right-hand is $1$.", "D": "$f(1)$ is not defined by the given definition ($x\\ne 1$)."}'::jsonb, ARRAY['Chapter 1.2: distinguishes one-sided vs two-sided limits', 'Classic absolute-value sign analysis'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 2, 1.1, 'symbolic', 'Both_Limit', 'Unit1_1.2', 'NewMaoS', 2026, 'No image needed; sign analysis for one-sided limits.', 0.7, 0.3, 'U1C1.2_OneSidedLimits_AbsRatio', 'text', 'SKL_OneSidedLimits', ARRAY['SKL_LimitExistence']
);

-- Q8
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.2', 'mcq', FALSE, 4, 105, ARRAY['LimitNotation', 'LimitLaws', 'DirectSubstitution'], ARRAY['DomainRestrictionIgnored', 'ConfusingFunctionValueWithLimit', 'ArithmeticSlip'], 'If $\lim_{x\to 2} (f(x)-3)=5$, what is $\lim_{x\to 2} f(x)$?', '\lim_{x\to 2}(f(x)-3)=5', '[{"id": "A", "text": "$2$"}, {"id": "B", "text": "$8$"}, {"id": "C", "text": "$5$"}, {"id": "D", "text": "$-8$"}]'::jsonb, 'B', NULL, 'Use limit laws: $$\lim_{x\to 2}(f(x)-3)=\lim_{x\to 2}f(x)-3=5,$$ so $\lim_{x\to 2}f(x)=8$.', '{"A": "This can happen if you subtract instead of add back the $3$.", "B": "Correct: add $3$ to both sides of the limit equation.", "C": "This is the given limit value of $f(x)-3$, not of $f(x)$.", "D": "This can happen from sign mistakes (treating $-3$ incorrectly)."}'::jsonb, ARRAY['Chapter 1.2: fluent translation between limit statements using laws', 'Targets a common algebra/sign slip'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 3, 1.1, 'symbolic', 'Both_Limit', 'Unit1_1.2', 'NewMaoS', 2026, 'No image needed; pure limit-law manipulation.', 0.7, 0.3, 'U1C1.2_LimitLaws_ShiftByConstant', 'text', 'SKL_LimitLaws', ARRAY['SKL_LimitNotation']
);

-- Q9
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.2', 'mcq', FALSE, 1, 60, ARRAY['LimitNotation', 'OneSidedLimits'], ARRAY['LeftRightMixUp', 'AssumingLimitExists', 'ConfusingArrowDirection'], 'Which notation correctly describes “the left-hand limit of $f(x)$ as $x$ approaches $5$”?', '\text{Left-hand limit at }x=5', '[{"id": "A", "text": "$\\displaystyle \\lim_{x\\to 5^+} f(x)$"}, {"id": "B", "text": "$\\displaystyle \\lim_{x\\to 5^-} f(x)$"}, {"id": "C", "text": "$\\displaystyle \\lim_{x\\to 5} f(5)$"}, {"id": "D", "text": "$\\displaystyle \\lim_{f(x)\\to 5^-} x$"}]'::jsonb, 'B', NULL, 'Approaching from the left uses $5^-$, so the left-hand limit is $$\lim_{x\to 5^-} f(x).$$', '{"A": "$5^+$ is the right-hand limit, not left-hand.", "B": "Correct: $x\\to 5^-$ means values less than $5$ approaching $5$.", "C": "This incorrectly treats $f(5)$ as varying and misuses limit notation.", "D": "This reverses the roles of input and output and is not standard for one-sided limits."}'::jsonb, ARRAY['Chapter 1.2: precise limit notation fluency', 'Quick check for left/right symbol accuracy'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 1, 0.7, 'symbolic', 'Both_Limit', 'Unit1_1.2', 'NewMaoS', 2026, 'No image needed; notation recognition.', 0.9, 0.1, 'U1C1.2_Notation_LeftHandLimit', 'text', 'SKL_LimitNotation', ARRAY['SKL_OneSidedLimits']
);

-- Q10
INSERT INTO public.questions (id, course, topic, sub_topic_id, type, calculator_allowed, difficulty, target_time_seconds, skill_tags, error_tags, prompt, latex, options, correct_option_id, tolerance, explanation, micro_explanations, recommendation_reasons, created_by, created_at, updated_at, status, version, reasoning_level, mastery_weight, representation_type, topic_id, section_id, source, source_year, notes, weight_primary, weight_supporting, title, prompt_type, primary_skill_id, supporting_skill_ids) VALUES (
  gen_random_uuid(), 'AP_Calculus_BC', 'Both_Limits', 'Unit1_1.2', 'mcq', FALSE, 5, 120, ARRAY['LimitExistence', 'OneSidedLimits', 'PiecewiseAnalysis'], ARRAY['LeftRightMixUp', 'AssumingLimitExists', 'ConfusingFunctionValueWithLimit'], 'Define $$f(x)=\begin{cases}2x+1,& x<0\\ x^2,& x\ge 0\end{cases}$$ What is $\lim_{x\to 0} f(x)$?', 'f(x)=\begin{cases}2x+1,& x<0\\ x^2,& x\ge 0\end{cases}', '[{"id": "A", "text": "$0$"}, {"id": "B", "text": "$1$"}, {"id": "C", "text": "Does not exist"}, {"id": "D", "text": "$2$"}]'::jsonb, 'C', NULL, 'Compute one-sided limits: for $x\to 0^-$, $f(x)=2x+1\to 1$. For $x\to 0^+$, $f(x)=x^2\to 0$. Since $1\ne 0$, the two-sided limit does not exist.', '{"A": "This is the right-hand limit ($x\\to 0^+$), not the two-sided limit.", "B": "This is the left-hand limit ($x\\to 0^-$), not the two-sided limit.", "C": "Correct: unequal one-sided limits imply the two-sided limit does not exist.", "D": "This can happen if you mistakenly substitute $x=1$ or confuse expressions across branches."}'::jsonb, ARRAY['Chapter 1.2: tests existence via matching one-sided limits', 'High-value piecewise limit skill for AP-style questions'], 'NewMaoS', '2026-02-07T00:00:00Z', '2026-02-07T00:00:00Z', 'published', 1, 2, 1.3, 'symbolic', 'Both_Limit', 'Unit1_1.2', 'NewMaoS', 2026, 'No image needed; piecewise one-sided limit comparison.', 0.7, 0.3, 'U1C1.2_LimitExistence_PiecewiseAt0', 'text', 'SKL_LimitExistence', ARRAY['SKL_PiecewiseAnalysis', 'SKL_OneSidedLimits']
);

-- Step 5: Re-enable triggers
ALTER TABLE public.questions ENABLE TRIGGER USER;

COMMIT;
